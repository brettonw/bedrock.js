<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Test</title>
    <link type="text/css" rel="stylesheet" href="../css/database.css?1"/>
    <link rel="icon" type="image/png" href="../img/icon.png?1"/>
</head>

<style>
    * {
        box-sizing: border-box;
    }

    html {
        -webkit-text-size-adjust: 100%;
        -moz-text-size-adjust: 100%;
        text-size-adjust: 100%;
    }

    body {
        font-family: sans-serif;
        font-size: 14px;
        color: black;
        text-align: left;
        width: 100%;
        max-width: 900px;
        margin: 0 auto !important;
        float: none !important;
    }

    div[id="databaseDisplay"] {
        margin-top: 15px;
        height: 500px;
        overflow-y: scroll;
        border: solid;
        border-width: 2px;
        border-color: black;
        padding: 4px;
    }

    .databaseLine {
        padding: 4px;
    }

    .odd {
        background-color: aliceblue;
    }

    .filterElementContainer {
        width: 129px;
    }
</style>

<body>
<div id="bedrockContainer"></div>
<div id="databaseDisplay"></div>
</body>
</html>

<script src="../js/html.js"></script>
<script src="../js/database.js"></script>
<script>
    let now = new Date ().getTime ();
    let request = new XMLHttpRequest ();
    request.overrideMimeType ("application/json");
    request.open ("GET", "bsc5-short.json?" + now, true);
    request.onload = function () {
        let database = JSON.parse (this.responseText);
        console.log ("loaded.");
        makeBedrock ({
            "database": database,
            "filterValues": [{ "field": "N" }],
            "onUpdate": function (db) {
                let innerHTML = "";
                let i = 0;
                for (let record of db) {
                    let recordHTML = "";
                    let keys = Object.keys (record).sort ();
                    let first = true;
                    for (let key of keys) {
                        if (!first) {
                            recordHTML += ", "
                        } else {
                            first = false;
                        }
                        recordHTML += "" + key + ": " + record[key] + "";
                    }
                    innerHTML += div ("databaseLine" + (((++i & 0x01) == 1) ? " odd" : ""), recordHTML);
                }
                document.getElementById ("databaseDisplay").innerHTML = innerHTML;
            }
        });
    };
    request.send ();
</script>
